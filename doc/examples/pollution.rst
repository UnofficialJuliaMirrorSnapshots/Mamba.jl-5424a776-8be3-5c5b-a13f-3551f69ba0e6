.. index:: Examples; Pollution: Bayesian Variable Selection

.. _example-Pollution:

Pollution: Bayesian Variable Selection
--------------------------------------

Data from McDonald and Schwing :cite:`mcdonald:1973:pol` that include 15 independent variables and a measure of mortality on 60 U.S. metropolitan areas in 1959-1961. Originally, the data were used to illustrate ridge regression (the full covariate matrix has a huge condition number). This dataset was included in a review of Bayesian variable selection techniques by O'Hara et al :cite:`ohara:2009:BVS`. 

Model
^^^^^

.. math::

    y_{i} &\sim \text{Normal}(\mu_i, \sigma) \quad\quad i=1, \ldots, 60 \\
    \mu_i &= \alpha + \sum_{j=1}^{15} \theta_j x_{ij} \\
    \theta_j &= \beta_j \gamma_j \\
    \alpha, \beta_j &\sim \text{Normal}(0, 1000) \\
    \gamma_j &\sim \text{Bernoulli}(0.5) \\
    \sigma^2 &\sim \text{InverseGamma}(0.0001, 0.0001) \\


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: pollution.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    ## Binary Hamiltonian Monte Carlo

    Iterations = 1002:10000
    Thinning interval = 2
    Chains = 1,2,3,4
    Samples per chain = 4500

    Empirical Posterior Estimates:
                   Mean           SD         Naive SE        MCSE         ESS
     gamma[1]    0.494666667   0.49998544 0.00372667146  0.0354668606  198.73265
     gamma[2]    0.147444444   0.35455827 0.00264272128  0.0244410034  210.44430
     gamma[3]    0.015611111   0.12396878 0.00092400872  0.0055061412  506.90895
     gamma[4]    0.082888889   0.27572186 0.00205510941  0.0154493001  318.51125
     gamma[5]    0.030722222   0.17256889 0.00128625256  0.0105253177  268.81567
     gamma[6]    0.318833333   0.46603724 0.00347363646  0.0336986753  191.25622
     gamma[7]    0.052777778   0.22359575 0.00166658436  0.0135283814  273.17152
     gamma[8]    0.039055556   0.19373256 0.00144399723  0.0068660579  796.14158
     gamma[9]    0.963111111   0.18849422 0.00140495300  0.0115061554  268.37102
    gamma[10]    0.014388889   0.11909088 0.00088765098  0.0047463037  629.57277
    gamma[11]    0.022888889   0.14955344 0.00111470550  0.0070783015  446.41078
    gamma[12]    0.094222222   0.29214575 0.00217752582  0.0191631169  232.41643
    gamma[13]    0.113000000   0.31660159 0.00235980895  0.0206601029  234.83414
    gamma[14]    0.598888889   0.49013706 0.00365326592  0.0327788035  223.58820
    gamma[15]    0.008333333   0.09090846 0.00067759165  0.0023285399 1524.19744
     theta[1]   10.963490356  11.99268806 0.08938821911  0.8074731491  220.58547
     theta[2]   -3.052823000   7.78859258 0.05805274150  0.5173033385  226.68742
     theta[3]   -0.180897422   1.69190595 0.01261072235  0.0669381806  638.85842
     theta[4]    1.445892275   5.77285839 0.04302834596  0.3387376553  290.43895
     theta[5]    0.220991524   1.67908086 0.01251512983  0.0755035072  494.54860
     theta[6]   -6.639050625  10.52547301 0.07845224381  0.7272107620  209.48969
     theta[7]   -0.569567370   2.97285383 0.02215834419  0.1667594094  317.80916
     theta[8]    0.469028055   2.61485474 0.01948997649  0.0924855110  799.36980
     theta[9]   32.862541601  12.24725603 0.09128565676  0.7176766659  291.21916
    theta[10]   -0.120870758   1.29895656 0.00968185058  0.0429416368  915.02312
    theta[11]   -0.111881745   3.05139958 0.02274378966  0.1397888103  476.48951
    theta[12]  -11.124331528  40.10862414 0.29895203352  2.8217496939  202.04056
    theta[13]    9.987999815  38.64436971 0.28803812538  2.7092141635  203.46316
    theta[14]   14.017636096  12.48284270 0.09304161608  0.8185848401  232.54103
    theta[15]    0.027299181   0.58218805 0.00433937350  0.0086425051 4500.00000
       sigma2 1675.673663690 421.46874551 3.14144255120 17.6104714349  572.78124
        alpha  937.545199598 187.23566554 1.39557225319 12.5267326120  223.40945

    Quantiles:
                  2.5%       25.0%       50.0%       75.0%        97.5%
     gamma[1]    0.000000    0.000000    0.000000    1.000000    1.0000000
     gamma[2]    0.000000    0.000000    0.000000    0.000000    1.0000000
     gamma[3]    0.000000    0.000000    0.000000    0.000000    0.0000000
     gamma[4]    0.000000    0.000000    0.000000    0.000000    1.0000000
     gamma[5]    0.000000    0.000000    0.000000    0.000000    1.0000000
     gamma[6]    0.000000    0.000000    0.000000    1.000000    1.0000000
     gamma[7]    0.000000    0.000000    0.000000    0.000000    1.0000000
     gamma[8]    0.000000    0.000000    0.000000    0.000000    1.0000000
     gamma[9]    0.000000    1.000000    1.000000    1.000000    1.0000000
    gamma[10]    0.000000    0.000000    0.000000    0.000000    0.0000000
    gamma[11]    0.000000    0.000000    0.000000    0.000000    0.0000000
    gamma[12]    0.000000    0.000000    0.000000    0.000000    1.0000000
    gamma[13]    0.000000    0.000000    0.000000    0.000000    1.0000000
    gamma[14]    0.000000    0.000000    1.000000    1.000000    1.0000000
    gamma[15]    0.000000    0.000000    0.000000    0.000000    0.0000000
     theta[1]    0.000000    0.000000    0.000000   22.137753   32.5989842
     theta[2]  -27.095671    0.000000    0.000000    0.000000    0.0000000
     theta[3]    0.000000    0.000000    0.000000    0.000000    0.0000000
     theta[4]    0.000000    0.000000    0.000000    0.000000   23.6631537
     theta[5]    0.000000    0.000000    0.000000    0.000000    2.2412885
     theta[6]  -30.773041  -15.262916    0.000000    0.000000    0.0000000
     theta[7]  -10.908665    0.000000    0.000000    0.000000    0.0000000
     theta[8]    0.000000    0.000000    0.000000    0.000000   10.3679336
     theta[9]    0.000000   25.808602   32.266120   39.686565   58.7865382
    theta[10]    0.000000    0.000000    0.000000    0.000000    0.0000000
    theta[11]    0.000000    0.000000    0.000000    0.000000    0.0000000
    theta[12] -163.621352    0.000000    0.000000    0.000000    0.0000000
    theta[13]  -10.012373    0.000000    0.000000    0.000000  155.4851914
    theta[14]    0.000000    0.000000   17.277061   24.764372   34.1579980
    theta[15]    0.000000    0.000000    0.000000    0.000000    0.0000000
       sigma2 1074.425951 1385.703616 1605.131816 1878.631424 2759.1883162
        alpha  663.986294  798.280105  878.440305 1099.826940 1314.4802623
